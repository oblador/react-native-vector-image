// This script removes .svg files generated by metro.

gradle.projectsEvaluated {
    def bundleTasks = tasks.findAll { task -> task.name.startsWith("bundle") && task.name.endsWith("JsAndAssets") && !task.name.contains("Debug") && task.enabled }
    android.applicationVariants.all { def variant ->
        def targetName = variant.name.capitalize()
        def targetPath = variant.dirName
        def bundleTask = tasks.findByName("bundle${targetName}JsAndAssets")
        def mergeResourcesTask = tasks.findByName("merge${targetName}Resources")
        def cleanUpTask = tasks.create(name: "${bundleTask.name}_VectorImageCleanUp", type: Delete) {
            description = "strip generated svg assets"
            group = 'react'
            delete fileTree("$buildDir/generated/res/react/${targetPath}/raw").matching {
                    include "*.svg"
                }
            enabled(targetName != "Debug" && bundleTask.enabled)
        }
        mergeResourcesTask.dependsOn(cleanUpTask)
    }
}
